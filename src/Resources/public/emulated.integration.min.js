window.ecBlurhash={config:{decodeDelay:200},imageNodes:[],imageNodesPostponed:[],placeholders:{},placeholderBase64:function(e,a){var t=e+"_"+a;if(ecBlurhash.placeholders[t])return ecBlurhash.placeholders[t];var r=document.createElement("canvas");r.width=e;r.height=a;return ecBlurhash.placeholders[t]=r.toDataURL("image/webp",1)},isImageCached:function(e){var a=new Image;a.src=e;var t=a.complete;a.src="";return t},isInViewport:function(e){return!0},isAncestorsVisible:function(e){var a=!0;do{var t=getComputedStyle(e);a=!(0===Number(t.opacity)||"none"===t.display);e=e.parentElement}while(null!==e&&!0===a);return a},prepareNode:function(e){var a=e.attributes.getNamedItem("data-blurhash");if(a&&!ecBlurhash.isImageCached(e.src)){var t=a.value,r=e.attributes.getNamedItem("data-ow"),h=e.attributes.getNamedItem("data-oh"),o=r?Number(r.value):0,s=h?Number(h.value):0;if(!isNaN(o)&&0!==o&&!isNaN(s)&&0!==s){var l=e.cloneNode(!0);l.srcset="";e.onload=function(){this.removeAttribute("data-blurhash");e.style.height=null;l.remove();l=null;this.onload=null};l.src=ecBlurhash.placeholderBase64(o,s);l.setAttribute("data-blurhash-placeholder","1");e.style.height="0";e.parentNode.insertBefore(l,e);ecBlurhash.imageNodes.unshift({node:e,hash:t,height:s,width:o,placeholder:l})}}},mutationHandler:function(e,a){for(var t=0;t<e.length;t++)for(var r=e[t],h=0;h<r.addedNodes.length;h++){var o=r.addedNodes[h];o.nodeType===Node.ELEMENT_NODE&&"IMG"===o.tagName&&!1===o.hasAttribute("data-blurhash-placeholder")&&ecBlurhash.prepareNode(o)}},decodeHashForImage:function(e){setTimeout((function(){if(e.placeholder.hasAttribute("data-blurhash")){var a=Blurhash.decodeBlurhash(e.hash,e.width,e.height);e.placeholder.hasAttribute("data-blurhash")&&Blurhash.onPixelsToBlobSrc((function(a){e.placeholder.src=a}),a,e.width,e.height);e.placeholder.removeAttribute("data-blurhash")}}),ecBlurhash.config.decodeDelay)},onDomInteractive:function(){for(;ecBlurhash.imageNodes.length;){var e=ecBlurhash.imageNodes.pop();ecBlurhash.isAncestorsVisible(e.node)&&("complete"===document.readyState||ecBlurhash.isInViewport(e.node))?ecBlurhash.decodeHashForImage(e):ecBlurhash.imageNodesPostponed.unshift(e)}},onDomComplete:function(){for(;ecBlurhash.imageNodesPostponed.length;){var e=ecBlurhash.imageNodesPostponed.pop();ecBlurhash.decodeHashForImage(e)}}};
